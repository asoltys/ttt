@model TransformationTimelineTool.Models.Comment

<style>
    #commentTextInput {
        width: 1100px;
        float: left;
        margin: 10px;
    }

    #addComment {
        margin: 10px;
    }
</style>

@Html.EditorFor(model => model.Content,
    new { htmlAttributes = new {
        @class = "form-control",
        @id = "commentTextInput",
        @accesskey = "c",
        @tabindex = "1"
    } })
@Html.ValidationMessageFor(model => model.Content, "", new { @class = "text-danger" })
<input id="addComment" type="button" value="@Resources.Add" class="btn btn-default" tabindex="2"/>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

<script type="text/javascript">
    $("#addComment").on("click", function () {
        var $input = $("#commentTextInput");
        if ($input.val().length == 0 || $input.val().length > 200) {
            alert("Comment needs to be greater than 0 character and less than 200 characters");
            var end = $input.val().length > 200 ? 200 : $input.val().length;
            $input.val($input.val().substring(0, end));
            return;
        }
        submitComment($input.val());
    });

    function clearField() {
        $("#commentTextInput").val("");
    }

    function submitComment(comment) {
        var temp = JSON.stringify({ comment: comment });
        $.ajax({
            type: "POST",
            contentType: "application/json",
            url: "/en/Comments/AddComment",
            data: temp,
            cache: false,
            success: function (response) {
                clearField();
                grabComments();
            }, error: function (response) {
                console.log(response);
            }
        });
    }
</script>
